"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ConfigContainer_1 = require("../ConfigContainer");
const DIContainer_1 = require("../../di/DIContainer");
const Path = require("path");
const ConfigException_1 = require("../error/ConfigException");
const Reflection_1 = require("../../core/Reflection");
/**
 * Config decorator expect a file name under process.cwd() + "config"
 * @param fileNameOrPath
 * @returns {(target:Function)=>undefined}
 * @constructor
 */
function Config(fileNameOrPath) {
    let path;
    if (Path.isAbsolute(fileNameOrPath)) {
        path = fileNameOrPath;
    }
    else {
        path = Path.resolve(process.cwd(), "config", fileNameOrPath);
    }
    return (target) => {
        if (Path.extname(fileNameOrPath) !== '.json') {
            throw new ConfigException_1.ConfigException(`[TYPED] only support json config file`);
        }
        const params = Reflection_1.Reflection.getParams(target);
        DIContainer_1.DIContainer.registerComponent(undefined, target, params);
        ConfigContainer_1.ConfigContainer.registerConfig(path);
    };
}
exports.Config = Config;
//# sourceMappingURL=Config.js.map